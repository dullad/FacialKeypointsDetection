# Kaggle 面部关键点检测 (Facial Keypoints Detection)

## 任务概述

目标：给定一张灰度人脸图（单人、96×96），预测人脸上 15 个关键点（keypoints） 的二维坐标，一共需要回归 30 个实数值。此任务常用于人脸对齐、表情/姿态分析、后续人脸识别或医学影像等场景。

评价指标：使用 Root Mean Squared Error (RMSE) 对所有预测坐标与真实坐标的偏差进行评估（即对 30 维数值取均方根误差）。训练目标就是尽量降低 RMSE。

## 数据集文件

*   **`training.csv`**: 训练数据集。
    *   30 列，代表 15 个关键点的 (x, y) 坐标，这些是模型的预测目标（label）。
    *   最后一列 `Image` 包含了 96x96 灰度图像的像素值。每个像素值以空格分隔，形成一个长字符串。
    *   注意：部分关键点坐标存在缺失值，需要进行预处理。

*   **`test.csv`**: 测试数据集。
    *   包含 `ImageId` 和 `Image` 两列。
    *   `Image` 列的格式与 `training.csv` 中的相同。
    *   你需要为这些图像预测 15 个关键点的坐标。

*   **`IdLookupTable.csv`**: 用于生成提交文件的查找表。
    *   它将测试集中的 `ImageId` 和需要预测的特征名称 (`FeatureName`，例如 `left_eye_center_x`) 映射到一个唯一的 `RowId`。
    *   在提交时，你需要根据这个表来填充每个 `RowId` 对应的预测值。

*   **`SampleSubmission.csv`**: 提交文件格式示例。
    *   包含 `RowId` 和 `Location` 两列。
    *   `RowId` 来自 `IdLookupTable.csv`。
    *   `Location` 是你模型预测出的对应关键点的坐标值。你需要将 `IdLookupTable.csv` 和你的预测结果合并，生成最终的提交文件。

## 探索方向

### 数据处理与特征工程

* 缺失值填充逻辑: 利用对称性填补缺失值。

* 输入输出归一化：坐标归一化到[-1, 1]，最后预测结果需要反归一化。

### 数据增强

* 几何变换：坐标点随之变换。`albumentations`库。
    * 随机水平翻转
    * 随机旋转
    * 随机平移/缩放
注意，需要先变换再归一化坐标。
水平翻转需要注意左右关键点的语义信息，会导致标签和图像错位，可以先不使用水平翻转。
需要注意增强后坐标不要超出边界范围。

* 学习率调度器，不要下降太快。

* 损失函数使用SmoothL1Loss

* 引入水平翻转

* 更换backbone
### backbone选择

### 输出头